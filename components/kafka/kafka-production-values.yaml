## ------------------------------------------------------
## Production Confluent Kafka on OpenShift
## ------------------------------------------------------

## Zookeeper Configuration (3 replicas for HA)
cp-zookeeper:
  enabled: true
  servers: 3
  image: confluentinc/cp-zookeeper
  imageTag: 6.1.0
  heapOptions: "-Xms1G -Xmx1G"

  persistence:
    enabled: true
    dataDirSize: 10Gi
    dataDirStorageClass: "nfs-harbor"
    dataLogDirSize: 10Gi
    dataLogDirStorageClass: "nfs-harbor"

  # OpenShift requires runAsUser: 0 or disable security context
  securityContext:
    runAsUser: 0

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 2Gi

## Kafka Brokers (3 replicas for HA)
cp-kafka:
  enabled: true
  brokers: 3
  image: confluentinc/cp-enterprise-kafka
  imageTag: 6.1.0
  heapOptions: "-Xms1G -Xmx1G"

  persistence:
    enabled: true
    storageClass: "nfs-harbor"
    size: 20Gi
    disksPerBroker: 1

  securityContext:
    runAsUser: 0

  resources:
    requests:
      cpu: 1000m
      memory: 2Gi
    limits:
      cpu: 2000m
      memory: 4Gi

  # Kafka configuration
  configurationOverrides:
    "offsets.topic.replication.factor": "3"
    "transaction.state.log.replication.factor": "3"
    "transaction.state.log.min.isr": "2"
    "default.replication.factor": "3"
    "min.insync.replicas": "2"
    "auto.create.topics.enable": "true"

## Schema Registry (for Avro/JSON schemas)
cp-schema-registry:
  enabled: true
  image: confluentinc/cp-schema-registry
  imageTag: 6.1.0
  replicaCount: 2
  heapOptions: "-Xms512M -Xmx512M"

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi

## Kafka Connect (for data integration)
cp-kafka-connect:
  enabled: true
  image: confluentinc/cp-kafka-connect
  imageTag: 6.1.0
  replicaCount: 2
  heapOptions: "-Xms1G -Xmx1G"

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 2Gi

## REST Proxy (HTTP interface to Kafka)
cp-kafka-rest:
  enabled: true
  image: confluentinc/cp-kafka-rest
  imageTag: 6.1.0
  replicaCount: 2
  heapOptions: "-Xms512M -Xmx512M"

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi

## KSQL Server (Stream processing)
cp-ksql-server:
  enabled: true
  image: confluentinc/cp-ksqldb-server
  imageTag: 6.1.0
  replicaCount: 2
  heapOptions: "-Xms1G -Xmx1G"

  ksql:
    headless: false

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 2Gi

## Control Center (Monitoring UI) - Optional, resource intensive
cp-control-center:
  enabled: false  # Enable later if needed

## Kafka Manager - Disabled (use Prometheus/Grafana instead)
cp-kafka-manager:
  enabled: false
